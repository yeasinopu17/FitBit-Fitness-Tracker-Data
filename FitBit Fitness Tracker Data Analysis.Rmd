---
title: "FitBit Fitness Tracker Data"
author: "Yeasin"
date: "7/8/2021"
output: html_document
---
# About
**Part of the Google Data Analytics Professional Certificate course (Capstone Project). **

[Click Here](https://www.kaggle.com/arashnic/fitbit) to Download **FitBit Fitness Tracker Data**

This is a data analytics fictional case study with the purpose of gaining insights to improve business decisions for the Bellabeat company, a company focused on building products designed to gather information about a woman's overall activity, sleep schedules, stress and reproductive health.

This analysis follows the same structure that was learned throughout this course, which is the following:

- Ask
- Prepare
- Process
- Analyze
- Share
- Act

For this fictitional case study, I have joined Bellabeat's marketing analytics team, responsible for collecting, analyzing and reporting data that helps guide Bellabeat's marketing strategy. This report's point of view will then be written as a (fictitional) team.

# Ask
In the Ask phase, we (the fictional team) should focus in what is the problem that we are trying to solve, and how can our insights drive business decisions.

#### Business Task
Bellabeat wants to gather insights regarding the following business tasks:

1. What are some trends in smart device usage?
2. How could these trends apply to Bellabeat customers?
3. How could these trends help influence Bellabeat marketing strategy?

#### Key Stakeholders

- Urška Sršen: Bellabeat's cofounder and Chief Creative Officer 
- Sando Mur: Mathematicion and Bellabeat's cofounder; key member of the Bellabeat executive team

#### How our insights will help

By analysing the activity of a particular set of costumers (that gave consent to share their activity's data), we can see what type of features are mostly used or impact the healthy lifestyle the most for those costumers. With these insights, Bellabeat's team can focus more on improving or spotlighting these features in marketing.

# Prepare
For this step, we'll take a closer look into the dataset that will be used for this case study and which will help us answer the previous business tasks. We'll give a brief overview regarding particular aspects of this dataset, such as how is the data being stored, how it's organized, bias/credibility issues (ROCC), licensing, privacy, security, acessibility, data's integrity, how does this data help answer our questions, and are there any problems with the data. Finally, this phase also includes the selection or filtering of the data available, and any sortage if necessary.

#### Data overview
The data [FitBit Fitness Tracker Data](https://www.kaggle.com/arashnic/fitbit) is available in Kaggle. As it is described in the dataset's page: "These datasets were generated by respondents to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016. Thirty eligible Fitbit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring. Individual reports can be parsed by export session ID (column A) or timestamp (column B). Variation between output represents use of different types of Fitbit trackers and individual tracking behaviors / preferences."

- Storage: The data is being currently being stored in Kaggle's platform and will also be downloaded to a local file system for any analysis or clean up.
- Organized: The databate consists of 18 CSV files:
    - dailyActivity_merged.csv
    - dailyCalories_merged.csv
    - dailyIntensities_merged.csv
    - dailySteps_merged.csv
    - heartrate_seconds_merged.csv
    - hourlyCalories_merged.csv
    - hourlyIntensities_merged.csv
    - hourlySteps_merged.csv
    - minuteCaloriesNarrow_merged.csv
    - minuteCaloriesWide_merged.csv
    - minuteIntensitiesNarrow_merged.csv
    - minuteIntensitiesWide_merged.csv
    - minuteMETsNarrow_merged.csv
    - minuteSleep_merged.csv
    - minuteStepsNarrow_merged.csv
    - minuteStepsWide_merged.csv
    - sleepActivities_merged.csv
    - weightLogInfo_merged.csv
- Bias/Credibility (ROCC)
    - Reliable: is the data accurate, complete, and non-biased?
        - Can't be entirely sure if it is.
- Original: can we locate the original data source?
    - Yes, as described in their dataset's metadata
- Comprehensive: Does it have the necessary and important information to find the solution?
    - Yes, by looking into the device's data, we can see the usage trends, which is what we are trying to discover.
- Current: Yes it current?
    - No, all the data is from 2016.
- Cited:
    - Yes, as described in their dataset's metadata
- Licence, privacy, security, acessability, data's integrity
According to the description of the dataset, thirty eligible Fitbit users consented to the submission of personal tracker data. Looking into the metadata, the data was made public with the following license: CCO: Public Domain.

- Problems with the data
The data is not current (from 2016), has a relatively small sample size (30 costumers) and can not be sure if the data is actually representative of women, or if it's biased in some way.

#### Data Selection
The entire data is distributed across multiple files, and the observations (rows) on each file are registered by different time intervals. Some are high intervals such as dailyActivity_merged.csv where each observation is on a daily basis, while others are low intervals (heartrate_seconds_merged.csv) where each observation is measured by the second. To have a generic view of the usage trends of Bellabeat's costumers, we will focus on the files with higher intervals observations, which are the following:

- dailyActivity_merged.csv
- dailyCalories_merged.csv
- dailyIntensities_merged.csv
- dailySteps_merged.csv
- sleepDay_merged.csv
- weightLogInfo_merged.csv
But, looking into these datasets, we can see that dailyActivity_merged.csv already contains all the columns of either dailyCalories, dailyIntensities and dailySteps files. Also, by having a quick look at the weightLogInfo_merged.csv file, it only contains weight information about 9 costumers, so this file won't be used as well. We end up with the following files:

- dailyActivity_merged.csv
- sleepDay_merged.csv

# Process and Analysis
We will combine both steps (Process and Analysis) into this one section.

- Process: In the Process phase, the key tasks include checking data for errors, choosing the appropriate or most desired tools to do so, transform the data so we can work with it effectively and document the entire cleaning process. The tool we chose to clean the data was R.

- Analysis: The Analysis phase consists of aggregating the data so it's useful and accessible, organizing and formatting the data, perform any necessary calculations and identify trends and relationships.

As described in the previous phase, the files that were left off for us to work with are the **dailyActivity_merged.csv** and the **sleepDay_merged.csv**. There maybe a correlation between the sleep behaviours and the overall activity of the costumers, so the next step will be to merge the two files together so we can have a single data frame to work with.
```{r load library, message=FALSE, warning=FALSE}
library(tidyverse)
library(lubridate)
library(skimr)
```
Loading Files:
```{r Loading File}
dailyActivities <- read_csv("data/dailyActivity_merged.csv")
sleepActivities  <- read_csv("data/sleepDay_merged.csv")
head(dailyActivities)
head(sleepActivities)
```
As we can see, we have the Id and ActivityDate for the dailyActivities data frame, and the Id and sleepActivities for the sleepActivities data frame. Both of these columns will be used to make the merge but first we need to make a few changes. R has identified both date-related columns as a Factor or categorical variable (fct). Also, ActivityDate is representing a date, while sleepActivities is date-time. This date-time however is unecessary as they all show the exact same time (12 am). So the next steps will be to:

1. Changing the format of ActivityDate and sleepActivities to a date-related format usable by R. (will be using lubridate package).
2. Rename both date columns to have the same name (this is unecessary for the merge since you can specify the columns but it will be more clearer to do so.
3. Merge both data frames.
4. Quick look into the final merge result.

#### Step 1: Changing the format of columns ActivityDate and sleepActivities
Using lubridate library, we can use the mdy function in order to parse the date (mdy because the current column date format is in month/day/year).
```{r changing date}
dailyActivities <- mutate(dailyActivities, ActivityDate = mdy(ActivityDate))
sleepActivities <- mutate(sleepActivities, SleepDay = mdy_hms(SleepDay))
```

Now it is a date! and it's in the default date format (and much more readable format: Year > month > day). Let's quickly recheck:

```{r}
head(dailyActivities)
head(sleepActivities)
```
#### Step 2: Renaming both columns ActivityDate and sleepActivities to simply 'Date
```{r rename date column}
dailyActivities <- rename(dailyActivities, Date = ActivityDate)
sleepActivities <- sleepActivities %>% rename(Date = SleepDay)
glimpse(dailyActivities)
glimpse(sleepActivities)
```
#### Step 3: Merging both data frames.
Before merging data frames, let's just see if all our costumers in one data frame are also present in the other. We can simply do this by counting the number of distinct **Id's** in both data frames.
```{r distinct ids}
n_distinct(dailyActivities$Id)
n_distinct(sleepActivities$Id)
```
Apparently not all costumers have sleep data. In dailyActivities data frame there are 33 costumers, while in sleepActivities there are 24! In order to solve this. We've decided to use the dplyr library function, inner_join. This function will merge both data frames by Id and by Date and will only add observations or rows to the result if they are present in both data frames.
```{r merge}
mergeActivity <- inner_join(dailyActivities, sleepActivities, by=c("Id", "Date"))

```
#### Step 4: Looking into the final merge result
Let's now have an overview of our final data frame that we will work with using the skimr library. But first let's just add one more column to our new data frame to see who's been lazy or has insonia! Maybe it can have a correlation with the overall workout activity!
```{r check merged dataset}
mergeActivity <- mutate(mergeActivity, TimeAwakeInBed =  TotalTimeInBed - TotalMinutesAsleep)
n_distinct(mergeActivity$Id)
glimpse(mergeActivity)
skim(mergeActivity)
```

Let's just see if there's any duplicates in the final data frame:
```{r check duplicate Row}
sum(duplicated(mergeActivity))
# Removing duplicates from the data frame
mergeActivity <- distinct(mergeActivity)
```
# Exploratory Visualizations
Let's now do some obvious exploratory visualizations in R between variables that we are sure are correlated.

#### Relationship between TotalSteps and TotalDistance:
```{r}
ggplot(data = mergeActivity, aes(x=TotalSteps, y=TotalDistance)) +
    geom_point(color = "red") + labs(title = "Relationship between TotalSteps and TotalDistance")
```

#### Relationship between TotalSteps and Calories
```{r}
ggplot(data = mergeActivity, aes(x=TotalSteps, y=Calories)) +
    geom_point(color = "red") + labs(title = "Relationship between TotalSteps and Calories")
```

# Deeper Analysis
Let's now look at the actual behaviours of our costumers. We can analyse their sleep behaviours and if this has any impact with the overall activity. What type of activity they do the most, and in what time of the day or day of the week it's more likely for the costumers to do activity.

#### Possible analysis:

1. Sleep behaviours.
2. Most frequent types of activity.
3. Day of the week where there is more activity.
4. Relationship between sleep and activity.

#### 1. Sleep behaviours
```{r}
ggplot(mergeActivity, aes(x=TotalMinutesAsleep)) + 
    geom_histogram(aes(y=..density..) ,binwidth = 30, alpha = 0.6) +
    geom_density(alpha = 0.2, fill="blue") +
    labs(title = "Total Minute Asleep")
```

From this histogram, we can see that most of the costumers sleep around 420 minutes which equals to 7 hours a day.

